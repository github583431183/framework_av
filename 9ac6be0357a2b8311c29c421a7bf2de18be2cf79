{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c48746af_82e7748c",
        "filename": "services/audioflinger/Threads.cpp",
        "patchSetId": 1
      },
      "lineNbr": 3206,
      "author": {
        "id": 1060286
      },
      "writtenOn": "2022-06-22T15:45:34Z",
      "side": 1,
      "message": "is there a chance of overflowing  here? how large can mNormalFrameCount be?",
      "range": {
        "startLine": 3206,
        "startChar": 23,
        "endLine": 3206,
        "endChar": 50
      },
      "revId": "9ac6be0357a2b8311c29c421a7bf2de18be2cf79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52b1fc11_1f0ab24c",
        "filename": "services/audioflinger/Threads.cpp",
        "patchSetId": 1
      },
      "lineNbr": 3206,
      "author": {
        "id": 1060750
      },
      "writtenOn": "2022-06-23T15:07:08Z",
      "side": 1,
      "message": "There is a significant chance of overflowing if size_t is 32-bits.\nIf the mNormalFrameCount is \u003e\u003d 4294 then it would overflow.\nThat is about 89 msec at 48000 Hz.\n\nIf we need to run in a 32-bit mode then we should cast to uint64_t for the intermediate terms.",
      "parentUuid": "c48746af_82e7748c",
      "range": {
        "startLine": 3206,
        "startChar": 23,
        "endLine": 3206,
        "endChar": 50
      },
      "revId": "9ac6be0357a2b8311c29c421a7bf2de18be2cf79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6ee5bba_8662b73b",
        "filename": "services/audioflinger/Threads.cpp",
        "patchSetId": 1
      },
      "lineNbr": 3206,
      "author": {
        "id": 1931225
      },
      "writtenOn": "2022-06-24T01:49:35Z",
      "side": 1,
      "message": "I founded that some app will stop play after several minutes, when the playback thread is suspended, and the root cause is  MixerThread::suspendSleepTimeUs returned a smaller value.",
      "parentUuid": "52b1fc11_1f0ab24c",
      "range": {
        "startLine": 3206,
        "startChar": 23,
        "endLine": 3206,
        "endChar": 50
      },
      "revId": "9ac6be0357a2b8311c29c421a7bf2de18be2cf79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "959249c3_8297c571",
        "filename": "services/audioflinger/Threads.cpp",
        "patchSetId": 1
      },
      "lineNbr": 3206,
      "author": {
        "id": 1931225
      },
      "writtenOn": "2022-06-24T02:39:07Z",
      "side": 1,
      "message": "I tested it on ubuntu, the result shows that there is no overflow:\nyaoyongming@ubuntu-4-145:/work/oppo_yaoyongming/lab/overflow$ g++ 1.cpp \nyaoyongming@ubuntu-4-145:/work/oppo_yaoyongming/lab/overflow$ ./a.out   \nsizeof size_t     \u003d 8\nsizeof uint32_t   \u003d 4\nmNormalFrameCount \u003d 4294\nmSampleRate       \u003d 48000\nbefore result is  \u003d 89000\nafter  result is  \u003d 89458\n\nThe following shows the scenarios of the problems I found:\nyaoyongming@ubuntu-4-145:/work/oppo_yaoyongming/lab/overflow$ g++ 1.cpp \nyaoyongming@ubuntu-4-145:/work/oppo_yaoyongming/lab/overflow$ ./a.out   \nsizeof size_t     \u003d 8\nsizeof uint32_t   \u003d 4\nmNormalFrameCount \u003d 2048\nmSampleRate       \u003d 48000\nbefore result is  \u003d 42000\nafter  result is  \u003d 42666",
      "parentUuid": "d6ee5bba_8662b73b",
      "range": {
        "startLine": 3206,
        "startChar": 23,
        "endLine": 3206,
        "endChar": 50
      },
      "revId": "9ac6be0357a2b8311c29c421a7bf2de18be2cf79",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}