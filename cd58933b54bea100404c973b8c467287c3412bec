{
  "comments": [
    {
      "key": {
        "uuid": "81863480_7513bb46",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1108919
      },
      "writtenOn": "2020-06-15T20:24:00Z",
      "side": 1,
      "message": "so in order to avoid linking in libcrypto when in an apex,\nit seems that a believed-encrypted mpeg2ts instance with encryption will be pointed\nat the dummy/stub decryptor.  and that would seem to say that we won\u0027t be able to handle encrypted mpeg2ts streams in build where these live in an apex.\n\nthat doesn\u0027t feel right.",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ee87b5c8_454ca362",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1001525
      },
      "writtenOn": "2020-06-15T20:49:48Z",
      "side": 1,
      "message": "Good point. Dongwon, do you remember why you made this change the way you did?\nIt does seem possible for the mpeg-2 extractor to create an ATSParser for an encrypted stream, which in turn would create an ElementaryStreamQueue with the \"encrypted\" flag set, and it seems this would make that not work.\nOn the other hand, the change has been in internal R/master for a while, so either we have no tests for encrypted mpeg-2, or this doesn\u0027t work the way it would seem to at first glance.",
      "parentUuid": "81863480_7513bb46",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "db9bc6b8_9e3670ec",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1026966
      },
      "writtenOn": "2020-06-15T21:53:43Z",
      "side": 1,
      "message": "I cannot access my original CL, but IIRC. I checked the code history and the encrypted stream path was added for HLS use case, which is still in /system. I was told that there would be no mpeg2 ts extractor usage that uses encryption path.",
      "parentUuid": "ee87b5c8_454ca362",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c964bcf0_033d1626",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1039918
      },
      "writtenOn": "2020-06-15T22:00:06Z",
      "side": 1,
      "message": "As I remember the HLS code statically built its own copy of ATSParser and do not use the MediaExtractor on mainline. That\u0027s why the encryption is not needed on mainline.",
      "parentUuid": "db9bc6b8_9e3670ec",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a386643_307fae3e",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1047003
      },
      "writtenOn": "2020-06-15T22:13:43Z",
      "side": 1,
      "message": "Looking at the code, decryption is used only when AES key is set in ATSParser (signalNewSampleAesKey) and this is not called in mediaextractor path. This is set in libstagefright_httplive, which includes libstagefright_mpeg2support as a static library.\nSo the change looks fine.",
      "parentUuid": "c964bcf0_033d1626",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ec9392df_c37ea6f4",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1047003
      },
      "writtenOn": "2020-06-15T23:16:22Z",
      "side": 1,
      "message": "Marking this comment as resolved as the CL has a code-review +2, so that this can be submitted.",
      "parentUuid": "3a386643_307fae3e",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c3e4073b_83b57135",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1108919
      },
      "writtenOn": "2020-06-16T00:04:53Z",
      "side": 1,
      "message": "i\u0027d rather see 2 versions of the library -- \"mpeg2support\" and \"mpeg2support_nocrypto\" \nthat are built with the appropriate differences than using the APEX flags to control this.\n\nthe current library is static -- and presumably the new one would also be -- so there will not be any on-device space impact here.",
      "parentUuid": "3a386643_307fae3e",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9b42a056_8e7cd74b",
        "filename": "media/libstagefright/mpeg2ts/ESQueue.cpp",
        "patchSetId": 1
      },
      "lineNbr": 58,
      "author": {
        "id": 1047003
      },
      "writtenOn": "2020-06-16T00:21:21Z",
      "side": 1,
      "message": "Ray,\nI have filed b/159070321 to track this.",
      "parentUuid": "c3e4073b_83b57135",
      "range": {
        "startLine": 58,
        "startChar": 7,
        "endLine": 58,
        "endChar": 23
      },
      "revId": "cd58933b54bea100404c973b8c467287c3412bec",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}