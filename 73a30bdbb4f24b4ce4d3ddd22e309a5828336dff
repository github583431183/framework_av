{
  "comments": [
    {
      "key": {
        "uuid": "723ead8b_d942c102",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2018-03-14T23:49:05Z",
      "side": 1,
      "message": "i believe this should be done in clearInputBuffer_l()",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0c5fc04e_b8e1971e",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1243029
      },
      "writtenOn": "2018-03-16T01:20:50Z",
      "side": 1,
      "message": "Hi Andy,\nThank you for your comment.\nI\u0027m not sure about moving it to clearInputBuffer_l() since clearInputBuffer_l() is called many times from EffectChain::process_l().\nCould you give me your advice if we still should move it to clearInputBuffer_l()?",
      "parentUuid": "723ead8b_d942c102",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e21e4c5f_8e7a335d",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2018-03-16T02:00:33Z",
      "side": 1,
      "message": "you\u0027re right, i overlooked the draining. i had a knee-jerk reaction :-) to something being in the external call but not the internal locked version.\n\non review, i\u0027m not sure if this reset is suitable in clearInputBuffer() either since this is invoked for underruns, which may very well be intentional by the application.\n\nCould the pop be avoided by traditional means?  a volume ramp to 0 on the current track (we have the VolumeShaper) and then a ramp up on the next track?  Perhaps a cross-fade?",
      "parentUuid": "0c5fc04e_b8e1971e",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "43657cd7_676237f7",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1243029
      },
      "writtenOn": "2018-03-16T07:13:09Z",
      "side": 1,
      "message": "Hi Andy,\n\nSorry I could not understand what your below comment means. \n\"i\u0027m not sure if this reset is suitable in clearInputBuffer() either since this is invoked for underruns, which may very well be intentional by the application.\"\n\nWhat kind of problem could happen with this change?",
      "parentUuid": "e21e4c5f_8e7a335d",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a150df29_6b054771",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2018-03-16T07:19:38Z",
      "side": 1,
      "message": "If an application simply stopped writing AudioTrack data, the remaining buffered data should eventually drain out (triggering the underrun).  If we called reset here, it seems that would prematurely cut off the tail of the effect.",
      "parentUuid": "43657cd7_676237f7",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1d767c35_ee82419d",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1243029
      },
      "writtenOn": "2018-03-16T07:26:46Z",
      "side": 1,
      "message": "OK.. I got it. I\u0027m not sure if it causes actual problem from end user perspective since application stops playback intentionally in this case. Do you think the current change is not acceptable?",
      "parentUuid": "a150df29_6b054771",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a99aa882_43cdb5ab",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2018-03-16T07:30:38Z",
      "side": 1,
      "message": "With a track change, I\u0027m wondering if volume ramping / fade / cross fade is the right approach instead.  Traditionally these have been used to avoid pops.",
      "parentUuid": "1d767c35_ee82419d",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8f1710e_c24b0508",
        "filename": "services/audioflinger/Effects.cpp",
        "patchSetId": 2
      },
      "lineNbr": 1596,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2018-03-16T07:34:39Z",
      "side": 1,
      "message": "By that comment, the application becomes responsible for ensuring audio seamlessness by the data it sends, rather than imposing the burden on the underlying engine.  We have tools such as the VolumeShaper to make this easier.  I\u0027m not exactly sure your case of track switching, so if you can elaborate why reset must be done in the server, that would help me understand better, thanks!",
      "parentUuid": "a99aa882_43cdb5ab",
      "range": {
        "startLine": 1594,
        "startChar": 0,
        "endLine": 1596,
        "endChar": 5
      },
      "revId": "73a30bdbb4f24b4ce4d3ddd22e309a5828336dff",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}