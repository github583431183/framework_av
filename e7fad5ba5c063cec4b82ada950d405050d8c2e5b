{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "3ab33354_f4b55652",
        "filename": "media/libmedia/mediametadataretriever.cpp",
        "patchSetId": 1
      },
      "lineNbr": 153,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-09-11T14:16:42Z",
      "side": 1,
      "message": "nit: I would naturally use a ternary here and below\n\n```\nint colorFormat \u003d\n    playback_flags::mediametadataretriever_default_rgb8888() ? \n        HAL_PIXEL_FORMAT_RGB_888 :\n        HAL_PIXEL_FORMAT_RGB_565;\n```",
      "range": {
        "startLine": 150,
        "startChar": 0,
        "endLine": 153,
        "endChar": 5
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a006eb8_86049f58",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 4,
      "author": {
        "id": 1047003
      },
      "writtenOn": "2023-09-12T04:40:57Z",
      "side": 1,
      "message": "should this be rgb888 instead of rgb8888 (three 8 vs four 8)?",
      "range": {
        "startLine": 4,
        "startChar": 41,
        "endLine": 4,
        "endChar": 47
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "46de03e2_b779dd30",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 4,
      "author": {
        "id": 1047003
      },
      "writtenOn": "2023-09-12T05:01:59Z",
      "side": 1,
      "message": "Ian,\nb/298965955 Bug says ARGB_8888.\nBut does it really need ARGB_8888? RGB888 should be enough to achieve what is asked.\nCan you please confirm which is preferred?\nCL will be updated accordingly.\nThanks.",
      "parentUuid": "8a006eb8_86049f58",
      "range": {
        "startLine": 4,
        "startChar": 41,
        "endLine": 4,
        "endChar": 47
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d8ddbcd0_d53fb2ad",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 4,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-09-12T08:06:07Z",
      "side": 1,
      "message": "@arunjohnson@google.com You originally suggested ARGB_8888 in b/295092040#comment7 - would you be able to comment here on whether RGB888 would be sufficient or if it should definitely be ARGB_8888? Thanks!",
      "parentUuid": "46de03e2_b779dd30",
      "range": {
        "startLine": 4,
        "startChar": 41,
        "endLine": 4,
        "endChar": 47
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5917fe5_7242ef7c",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1047003
      },
      "writtenOn": "2023-09-12T04:40:57Z",
      "side": 1,
      "message": "RGB888",
      "range": {
        "startLine": 6,
        "startChar": 53,
        "endLine": 6,
        "endChar": 60
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7a2fa21d_5b6e1e21",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1939216
      },
      "writtenOn": "2023-09-12T16:17:53Z",
      "side": 1,
      "message": "RGB888 is good enough, i saw the banding appearing due to 565.",
      "parentUuid": "a5917fe5_7242ef7c",
      "range": {
        "startLine": 6,
        "startChar": 53,
        "endLine": 6,
        "endChar": 60
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03a2f693_12412ef9",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-09-12T16:20:18Z",
      "side": 1,
      "message": "Thanks Arun! I\u0027ve tweaked b/298965955 to reflect this - can we update this CL to consistently refer to `RGB_888` everywhere?",
      "parentUuid": "7a2fa21d_5b6e1e21",
      "range": {
        "startLine": 6,
        "startChar": 53,
        "endLine": 6,
        "endChar": 60
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cca131af_695ac6a3",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1068291
      },
      "writtenOn": "2023-09-15T06:06:39Z",
      "side": 1,
      "message": "The default color space set in [android_media_MediaMetadataRetriever.cpp](https://cs.android.com/android/platform/superproject/main/+/main:frameworks/native/include/android/bitmap.h;drc\u003dc0ed5f2df14e074de2a8f1a6e1dd98d0168a7429;l\u003d58) to RGBA_8888. The enum [AndroidBitmapFormat](https://cs.android.com/android/platform/superproject/main/+/main:frameworks/native/include/android/bitmap.h;drc\u003dc0ed5f2df14e074de2a8f1a6e1dd98d0168a7429;l\u003d58) doesn\u0027t have RGB_888 listed, only has RGBA_8888. I will continue with RGBA_8888 so that this change will be consistent with the earlier default.",
      "parentUuid": "03a2f693_12412ef9",
      "range": {
        "startLine": 6,
        "startChar": 53,
        "endLine": 6,
        "endChar": 60
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0842284b_1a059a29",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-09-19T12:58:07Z",
      "side": 1,
      "message": "huh, interesting - I hadn\u0027t realised that `android_media_MediaMetadataRetriever.cpp` sets a default value too (or maybe that\u0027s actually the only default that matters, because it never calls through to `mediametadataretriever.cpp` without specifying a `colorFormat`).\n\nIt also looks like [there\u0027s a comment](https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/media/jni/android_media_MediaMetadataRetriever.cpp;l\u003d377;drc\u003d3815d34e5f941909ceee9e879e309991c3d2a1d0) that\u0027s explicitly discouraging the change we\u0027re trying to make here:\n\n\u003e For getFrameAtTime family of calls, default to ANDROID_BITMAP_FORMAT_RGB_565 to keep the behavior consistent with older releases\n\nSpecifically it looks like `getFrameAtTime` [defaults to `ANDROID_BITMAP_FORMAT_RGB_565`](https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/media/jni/android_media_MediaMetadataRetriever.cpp;l\u003d379;drc\u003d3815d34e5f941909ceee9e879e309991c3d2a1d0) and `getFrameAtIndex` [defaults to `ANDROID_BITMAP_FORMAT_RGBA_8888`](https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/media/jni/android_media_MediaMetadataRetriever.cpp;l\u003d345;drc\u003d5d2d98a66685814bb4dc1c71749e5e9a01bf6d0b).\n\nLet me have a think/do some more research on this.",
      "parentUuid": "cca131af_695ac6a3",
      "range": {
        "startLine": 6,
        "startChar": 53,
        "endLine": 6,
        "endChar": 60
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "284aac1c_9f18f151",
        "filename": "media/libmedia/playback_flags.aconfig",
        "patchSetId": 1
      },
      "lineNbr": 6,
      "author": {
        "id": 1643005
      },
      "writtenOn": "2023-09-27T09:47:10Z",
      "side": 1,
      "message": "@dichenzhang@google.com - It looks like you approved the CL that added the comment I\u0027m a bit concerned about above: ag/9522824\n\nWould you be able to comment here whether it\u0027s safe to ignore this comment and change the default from 565 to 8888? It seems like it\u0027s well within the [documented behaviour of `MediaMetadataRetriever.getFrameAtTime`](https://developer.android.com/reference/android/media/MediaMetadataRetriever#getFrameAtTime(long,%20int)), since it just says \"the device will choose the actual Bitmap.Config to use\".\n\nChanging to 8888 here would also make `getFrameAtTime` and `getFrameAtIndex` behave consistently (they\u0027re currently inconsistent) which seems like a nice side benefit.",
      "parentUuid": "0842284b_1a059a29",
      "range": {
        "startLine": 6,
        "startChar": 53,
        "endLine": 6,
        "endChar": 60
      },
      "revId": "e7fad5ba5c063cec4b82ada950d405050d8c2e5b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}