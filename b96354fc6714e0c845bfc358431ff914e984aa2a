{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4b3d62ff_be4c8edf",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2023-09-01T09:07:59Z",
      "side": 0,
      "message": "There are other situations than preferred device where we need to invalidate the track and the client must be notified to create a new track in non offload mode.\nWe need to find a way to identify that we are in the context of a preferred device seleciton and the selected preferred device is compatible with offloading",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "355228de_a2095665",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 2041936
      },
      "writtenOn": "2023-09-05T04:43:53Z",
      "side": 0,
      "message": "Since createTrack_l is returning errno when it fail and restoreTrack_l will add CBLK_INVALID into mCblk-\u003emFlags, then client will eventually be notified to create new track. Should we still need to identify it\u0027s context of a preferred device?",
      "parentUuid": "4b3d62ff_be4c8edf",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21570712_a0c42ac9",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2023-09-05T17:58:51Z",
      "side": 0,
      "message": "Offload situations may cause a loss of 20-30 seconds of audio.  It is often better to invalidate (and seek the the last location).  I can see for direct tracks this may be okay to retry.",
      "parentUuid": "355228de_a2095665",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aaaeb7c3_2c421268",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 2041936
      },
      "writtenOn": "2023-09-07T13:55:43Z",
      "side": 0,
      "message": "The current preferred device flow is using restoreTrack to trigger getOutputForAttr in policy and the mSelectedDeviceId is kept in AudioTrack instance. So it\u0027s not possible to invalidate track and notify client to re-create a new one which mSelectedDeviceId is reset when offloading. Unless the preferred device can be configured via set() which need modify the flow from java to native. Is this okay to you? Or just support preferred device for direct but not offload?",
      "parentUuid": "21570712_a0c42ac9",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0ec22794_dfecb7b2",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2023-09-07T16:38:55Z",
      "side": 0,
      "message": "Maybe only allow retry for offloaded when mSelectedDeviceId !\u003d AUDIO_PORT_HANDLE_NONE?  Would that work?",
      "parentUuid": "aaaeb7c3_2c421268",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "21e4eb91_a7705cdd",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 2041936
      },
      "writtenOn": "2023-09-08T06:42:36Z",
      "side": 0,
      "message": "Since \"A value of AUDIO_PORT_HANDLE_NONE indicates default (AudioPolicyManager) routing.\" from api description, AUDIO_PORT_HANDLE_NONE should be valid to restore track, so I think there will be side effect when checking \"offloaded when mSelectedDeviceId !\u003d AUDIO_PORT_HANDLE_NONE\".",
      "parentUuid": "0ec22794_dfecb7b2",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e6fb85c3_9ed67ad5",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2023-09-08T13:04:03Z",
      "side": 0,
      "message": "Actually, I like the change for another reason - it permits the restore/reetry only once.  I was thinking of suggesting something similar.",
      "parentUuid": "21e4eb91_a7705cdd",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a3c0f93e_37d0d04d",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 2
      },
      "lineNbr": 2830,
      "author": {
        "id": 1478901
      },
      "writtenOn": "2024-01-30T07:14:35Z",
      "side": 0,
      "message": "\u003e Actually, I like the change for another reason - it permits the restore/reetry only once.  I was thinking of suggesting something similar.",
      "parentUuid": "e6fb85c3_9ed67ad5",
      "range": {
        "startLine": 2830,
        "startChar": 0,
        "endLine": 2830,
        "endChar": 53
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b923ab1a_8e8dd170",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1694,
      "author": {
        "id": 2041936
      },
      "writtenOn": "2023-09-08T06:42:36Z",
      "side": 0,
      "message": "This is modified due to an related issue, I will update analysis into bug.",
      "range": {
        "startLine": 1690,
        "startChar": 0,
        "endLine": 1694,
        "endChar": 74
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "17bb04b2_af71d8d7",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1694,
      "author": {
        "id": 1659435
      },
      "writtenOn": "2023-09-08T09:51:31Z",
      "side": 0,
      "message": "b/297164626#comment8",
      "parentUuid": "b923ab1a_8e8dd170",
      "range": {
        "startLine": 1690,
        "startChar": 0,
        "endLine": 1694,
        "endChar": 74
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "632820b1_8e7d5c95",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1694,
      "author": {
        "id": 1659435
      },
      "writtenOn": "2023-09-08T13:17:31Z",
      "side": 0,
      "message": "Done",
      "parentUuid": "17bb04b2_af71d8d7",
      "range": {
        "startLine": 1690,
        "startChar": 0,
        "endLine": 1694,
        "endChar": 74
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bf8fb02e_94351b1e",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1694,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2023-09-08T14:20:18Z",
      "side": 0,
      "message": "Eric, perhaps we need a race-free way to update APM\u0027s TrackClientDescriptor\u0027s preferred/selected device id without a full restore of the track (if it is currently correctly routed)?",
      "parentUuid": "632820b1_8e7d5c95",
      "range": {
        "startLine": 1690,
        "startChar": 0,
        "endLine": 1694,
        "endChar": 74
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d21858e3_941ae62b",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1694,
      "author": {
        "id": 1478901
      },
      "writtenOn": "2023-09-15T03:24:10Z",
      "side": 0,
      "message": "Eric, Andy, do we need another solution for this problem?",
      "parentUuid": "bf8fb02e_94351b1e",
      "range": {
        "startLine": 1690,
        "startChar": 0,
        "endLine": 1694,
        "endChar": 74
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e33e8878_ca10b0da",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 3
      },
      "lineNbr": 1694,
      "author": {
        "id": 1478901
      },
      "writtenOn": "2024-01-30T07:14:35Z",
      "side": 0,
      "message": "Done",
      "parentUuid": "d21858e3_941ae62b",
      "range": {
        "startLine": 1690,
        "startChar": 0,
        "endLine": 1694,
        "endChar": 74
      },
      "revId": "b96354fc6714e0c845bfc358431ff914e984aa2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}