{
  "comments": [
    {
      "key": {
        "uuid": "123fe8e9_fd7ea79c",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 532,
      "author": {
        "id": 1001525
      },
      "writtenOn": "2016-05-09T04:22:41Z",
      "side": 1,
      "message": "The commit message talks about this line, however this line is protected by the check on line 530.",
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "123fe8e9_7d14573c",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 628,
      "author": {
        "id": 1090168
      },
      "writtenOn": "2016-05-09T05:06:21Z",
      "side": 1,
      "message": "The commit message says this line.",
      "range": {
        "startLine": 628,
        "startChar": 0,
        "endLine": 628,
        "endChar": 41
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "123fe8e9_83cf423b",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 628,
      "author": {
        "id": 1001525
      },
      "writtenOn": "2016-05-09T16:29:56Z",
      "side": 1,
      "message": "Why not add the check in this function then? That seems safer in case another caller to this function is ever added.",
      "parentUuid": "123fe8e9_7d14573c",
      "range": {
        "startLine": 628,
        "startChar": 0,
        "endLine": 628,
        "endChar": 41
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "123fe8e9_9d0a0317",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1090168
      },
      "writtenOn": "2016-05-09T05:12:10Z",
      "side": 1,
      "message": "If the offset is negative, this line may also be a problem.",
      "range": {
        "startLine": 646,
        "startChar": 0,
        "endLine": 646,
        "endChar": 62
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "123fe8e9_3dfdaf17",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1090168
      },
      "writtenOn": "2016-05-09T05:15:38Z",
      "side": 1,
      "message": "On 64-bit cpu, off64_t will be automatically converted into unsigned type operations.",
      "range": {
        "startLine": 646,
        "startChar": 0,
        "endLine": 646,
        "endChar": 62
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "123fe8e9_c30dca32",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1001525
      },
      "writtenOn": "2016-05-09T16:29:56Z",
      "side": 1,
      "message": "We don\u0027t yet support running the media framework in 64-bit (it runs in 32-bit mode even on 64-bit CPUs).\nCan you update the commit message to say that this is a fix for 64-bit mode?\nAnd still, this is only a problem if offset is negative, right? Who\u0027s calling it with a negative offset?",
      "parentUuid": "123fe8e9_3dfdaf17",
      "range": {
        "startLine": 646,
        "startChar": 0,
        "endLine": 646,
        "endChar": 62
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9286782c_88472a69",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1090168
      },
      "writtenOn": "2016-05-10T03:20:31Z",
      "side": 1,
      "message": "There are also problems on 32bit.\nE.g.\nwhen offset \u003c 0.\n\n    if (offset \u003c mCacheOffset\n            || offset \u003e\u003d (off64_t)(mCacheOffset + mCache-\u003etotalSize())) {\n        ...\n        seekInternal_l(seekOffset); // seekOffset \u003d 0; mCacheOffset \u003d seekOffset \u003d 0;\n        ...\n    }\n    size_t delta \u003d offset - mCacheOffset; // delta \u003d (size_t)(offset) \n    if (offset + size \u003c\u003d mCacheOffset + mCache-\u003etotalSize()) {   // mCacheOffset + mCache-\u003etotalSize() \u003d\u003d 0, when offset + size \u003c 0, but delta \u003e 0.\n\n    mCache-\u003ecopy(delta, data, size); // delta is very large.\n    ...\n   }",
      "parentUuid": "123fe8e9_c30dca32",
      "range": {
        "startLine": 646,
        "startChar": 0,
        "endLine": 646,
        "endChar": 62
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9286782c_28247ea3",
        "filename": "media/libstagefright/NuCachedSource2.cpp",
        "patchSetId": 2
      },
      "lineNbr": 646,
      "author": {
        "id": 1090168
      },
      "writtenOn": "2016-05-10T03:20:31Z",
      "side": 1,
      "message": "Who\u0027s calling it with a negative offset?\nMany vendor(e.g.: qcom, mediatek) multimedia library calls MediaSource, causing a large number of crash, many crash because offset negative. Therefore, we can avoid this problem when you call readAt.",
      "range": {
        "startLine": 646,
        "startChar": 4,
        "endLine": 646,
        "endChar": 62
      },
      "revId": "6915f3e18f3d9ad95816f395062512384632e5c3",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}