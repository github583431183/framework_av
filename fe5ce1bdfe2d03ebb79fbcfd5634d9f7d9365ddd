{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7c5bc845_74e1986e",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 1
      },
      "lineNbr": 365,
      "author": {
        "id": 1040213
      },
      "writtenOn": "2021-12-08T02:32:09Z",
      "side": 0,
      "message": "I would prefer not to remove this as stopAndJoinCallbacks is a public method, and may be called multiple times.  (once explicitly, and once on destruction).\n\nRegardless, removing it won\u0027t help the race condition with the reference to mDeviceCallback on line 361. That cannot be left unprotected while mDeviceCallback is cleared.\n\nIt would be better to put this under lock or make mDeviceCallback an atomic_wp.",
      "range": {
        "startLine": 365,
        "startChar": 0,
        "endLine": 365,
        "endChar": 32
      },
      "revId": "fe5ce1bdfe2d03ebb79fbcfd5634d9f7d9365ddd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6ab7ee1e_d7d5b7a3",
        "filename": "media/libaudioclient/AudioTrack.cpp",
        "patchSetId": 1
      },
      "lineNbr": 365,
      "author": {
        "id": 1902032
      },
      "writtenOn": "2021-12-08T02:52:40Z",
      "side": 0,
      "message": "you can check this commit 7a9577cbb13\n\nthe line 360 Annotation \"No lock here: worst case we remove a NULL callback which will be a nop\"\nso it should not to add lock here.\n\nAnd since this is a wp, so do not clear the mDeviceCallback in stopAndJoinCallbacks have no side effect.\n\nyou can check the commit 7a9577cbb13, AudioRecord and AudioTrack have the same logic but not call mDeviceCallback.clear()\n\nalso, the mDeviceCallback.clear() is introduced by 7a9577cbb13.",
      "parentUuid": "7c5bc845_74e1986e",
      "range": {
        "startLine": 365,
        "startChar": 0,
        "endLine": 365,
        "endChar": 32
      },
      "revId": "fe5ce1bdfe2d03ebb79fbcfd5634d9f7d9365ddd",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}