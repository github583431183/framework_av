{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e9f5d4f0_40204349",
        "filename": "services/audiopolicy/common/managerdefinitions/src/AudioPolicyMix.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1002682
      },
      "writtenOn": "2024-03-20T16:35:58Z",
      "side": 1,
      "message": "can you document when that is the case?",
      "range": {
        "startLine": 57,
        "startChar": 52,
        "endLine": 57,
        "endChar": 84
      },
      "revId": "43fd72f312d0756be00b98aa8efdbb956369c73c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6846584c_4c53f37b",
        "filename": "services/audiopolicy/common/managerdefinitions/src/AudioPolicyMix.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2024-03-20T16:39:17Z",
      "side": 1,
      "message": "and also when we can have a criteria with a RULE_MATCH_UID but a uid of 0 in criterion.mValue.mUid",
      "parentUuid": "e9f5d4f0_40204349",
      "range": {
        "startLine": 57,
        "startChar": 52,
        "endLine": 57,
        "endChar": 84
      },
      "revId": "43fd72f312d0756be00b98aa8efdbb956369c73c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02ddbb50_16f920b5",
        "filename": "services/audiopolicy/common/managerdefinitions/src/AudioPolicyMix.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1491204
      },
      "writtenOn": "2024-03-20T17:12:46Z",
      "side": 1,
      "message": "When a getDeviceForAttributes is called by AudioService to get the volume device, mixes are taken into account.\nHowever, as no UID is provided, AudioPolicyManager is using UID\u003d0:\n\nhttps://cs.android.com/android/platform/superproject/main/+/main:frameworks/av/services/audiopolicy/managerdefault/AudioPolicyManager.cpp;l\u003d8513?q\u003dgetDevicesForAttributes\u0026ss\u003dandroid%2Fplatform%2Fsuperproject%2Fmain\u0026start\u003d11\n\nAs a result, if a rule of exclusion is set on current user, this rule is not correctly handled, thus the criteria is matching and we select wrong device for volume.\n\nClean fix will be to have UID....\n\nSecond case: registering a matching rule with UID\u003d0 --\u003e this case does not happen today (CarService only registers matching rule with USAGE\u003dUNKNOWN)",
      "parentUuid": "6846584c_4c53f37b",
      "range": {
        "startLine": 57,
        "startChar": 52,
        "endLine": 57,
        "endChar": 84
      },
      "revId": "43fd72f312d0756be00b98aa8efdbb956369c73c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9f3d462a_a227bc3c",
        "filename": "services/audiopolicy/common/managerdefinitions/src/AudioPolicyMix.cpp",
        "patchSetId": 2
      },
      "lineNbr": 57,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2024-03-20T17:21:08Z",
      "side": 1,
      "message": "what about my question: why do we have a rule RULE_MATCH_UID with a UID 0 in the criteria? because if we have a valid UID, there won\u0027t be a match with UID 0.",
      "parentUuid": "02ddbb50_16f920b5",
      "range": {
        "startLine": 57,
        "startChar": 52,
        "endLine": 57,
        "endChar": 84
      },
      "revId": "43fd72f312d0756be00b98aa8efdbb956369c73c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fdbdc033_db0992d3",
        "filename": "services/audiopolicy/common/managerdefinitions/src/AudioPolicyMix.cpp",
        "patchSetId": 2
      },
      "lineNbr": 67,
      "author": {
        "id": 1002682
      },
      "writtenOn": "2024-03-21T00:37:50Z",
      "side": 1,
      "message": "repeating my request here: clarify in the comment that no uid is provided by the caller, and is therefore 0, for volume commands. Here and for UID.",
      "range": {
        "startLine": 67,
        "startChar": 52,
        "endLine": 67,
        "endChar": 84
      },
      "revId": "43fd72f312d0756be00b98aa8efdbb956369c73c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "af7135c2_49365190",
        "filename": "services/audiopolicy/common/managerdefinitions/src/AudioPolicyMix.cpp",
        "patchSetId": 2
      },
      "lineNbr": 67,
      "author": {
        "id": 1491204
      },
      "writtenOn": "2024-03-21T08:42:12Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fdbdc033_db0992d3",
      "range": {
        "startLine": 67,
        "startChar": 52,
        "endLine": 67,
        "endChar": 84
      },
      "revId": "43fd72f312d0756be00b98aa8efdbb956369c73c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}