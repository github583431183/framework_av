{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7e9df462_63ed8e1e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1108919
      },
      "writtenOn": "2023-03-29T11:59:19Z",
      "side": 1,
      "message": "my comments are mostly for clarification, not that i saw anything wrong.",
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2bebc714_0733c874",
        "filename": "drm/libmediadrm/DrmMetricsLogger.cpp",
        "patchSetId": 2
      },
      "lineNbr": 201,
      "author": {
        "id": 1108919
      },
      "writtenOn": "2023-03-29T11:59:19Z",
      "side": 1,
      "message": "if we failed to close, it stays in the session map. at least as far as this\nroutine is concerned.\n\nis there some other place that will harvest these sessions that failed to close\nor will they accumulate through the life of the process?",
      "range": {
        "startLine": 201,
        "startChar": 7,
        "endLine": 201,
        "endChar": 23
      },
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd59140e_249a1241",
        "filename": "drm/libmediadrm/DrmMetricsLogger.cpp",
        "patchSetId": 2
      },
      "lineNbr": 201,
      "author": {
        "id": 1043093
      },
      "writtenOn": "2023-03-29T16:36:59Z",
      "side": 1,
      "message": "You are correct, if a session failed to close, we assume it is still open. The entries in the map will linger until the java MediaDrm object goes away.\n\nI don\u0027t think we have an API to check with the HAL whether a session is open or not. We can consider adding this session garbage collect feature in future releases.",
      "parentUuid": "2bebc714_0733c874",
      "range": {
        "startLine": 201,
        "startChar": 7,
        "endLine": 201,
        "endChar": 23
      },
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5f55843a_73e6abdb",
        "filename": "drm/libmediadrm/DrmMetricsLogger.cpp",
        "patchSetId": 2
      },
      "lineNbr": 201,
      "author": {
        "id": 1108919
      },
      "writtenOn": "2023-03-29T16:51:47Z",
      "side": 1,
      "message": "I don\u0027t know the lifetime of the mediadrm object, so it\u0027s hard to judge the impact. it is a behavioral change since the old code always removed it from the map even if the session didn\u0027t close successfully.\n\nFile a bug to revisit this to:\nfigure out impact of this accumulation,\ndecide about adding an API to clean them out,\nand doing whatever work comes from that.\nrefence the bug here in the gerrit record\nreference the bug with a TODO in the code:\n  TODO(b/#) how to reclaim sessions from the map if the close fails",
      "parentUuid": "fd59140e_249a1241",
      "range": {
        "startLine": 201,
        "startChar": 7,
        "endLine": 201,
        "endChar": 23
      },
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1d5f34d2_8f66c585",
        "filename": "drm/libmediadrm/DrmMetricsLogger.cpp",
        "patchSetId": 2
      },
      "lineNbr": 201,
      "author": {
        "id": 1043093
      },
      "writtenOn": "2023-03-29T17:13:24Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5f55843a_73e6abdb",
      "range": {
        "startLine": 201,
        "startChar": 7,
        "endLine": 201,
        "endChar": 23
      },
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "57e5516c_dada064a",
        "filename": "drm/libmediadrm/include/mediadrm/DrmMetricsLogger.h",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1108919
      },
      "writtenOn": "2023-03-29T11:59:19Z",
      "side": 1,
      "message": "does this table need to be kept in sync with any other table,\nmaybe off in the statsd/metrics side of things?\n\nif so, let\u0027s add a comment pointing in that direction.\n\nif it\u0027s purely internal to the mediadrm module, then we don\u0027t need such.",
      "range": {
        "startLine": 29,
        "startChar": 2,
        "endLine": 29,
        "endChar": 8
      },
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "cfa0cf1d_5c2e49f5",
        "filename": "drm/libmediadrm/include/mediadrm/DrmMetricsLogger.h",
        "patchSetId": 2
      },
      "lineNbr": 29,
      "author": {
        "id": 1043093
      },
      "writtenOn": "2023-03-29T16:36:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "57e5516c_dada064a",
      "range": {
        "startLine": 29,
        "startChar": 2,
        "endLine": 29,
        "endChar": 8
      },
      "revId": "051e4b3f38514b9ce2aa894ab5dc58676dfa7dd7",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}