{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "12c8c554_a447ee23",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1122898
      },
      "writtenOn": "2023-09-07T03:54:32Z",
      "side": 1,
      "message": "we meet the null pointer dereference issues in our Monkey test (in some 3rd camera applications), here\u0027s trace\n\n----\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : Build fingerprint: \u0027Xiaomi/ishtar/ishtar:14/UKQ1.230730.001/23.8.25:user/release-keys\u0027\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : Revision: \u00270\u0027\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : ABI: \u0027arm64\u0027\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : Timestamp: 2023-08-26 04:36:57.799221265+0800\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : Process uptime: 32s\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : Cmdline: com.mipay.wallet\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : pid: 24834, tid: 24834, name: om.mipay.wallet \u003e\u003e\u003e com.mipay.wallet \u003c\u003c\u003c\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : uid: 10250\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : tagged_addr_ctrl: 0000000000000001 (PR_TAGGED_ADDR_ENABLE)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : pac_enabled_keys: 000000000000000f (PR_PAC_APIAKEY, PR_PAC_APIBKEY, PR_PAC_APDAKEY, PR_PAC_APDBKEY)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x0000000000000030\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : Cause: null pointer dereference\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x0 0000000000000000 x1 0000000000000000 x2 b4000078365b7ebc x3 0000000000000001\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x4 0000000000000000 x5 0000000000000000 x6 0000000000000000 x7 7f7f7f7f7f7f7f7f\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x8 d9c4098c2e472aec x9 d9c4098c2e472aec x10 0000000000000009 x11 0000000000000001\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x12 00000079b8a92030 x13 0000000000000000 x14 00000000005df6e0 x15 00000038047d0b38\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x16 00000079b5f74108 x17 00000079984c9294 x18 0000007fc5732af4 x19 b4000078365b7ebc\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x20 b4000078365b7e80 x21 00000079b7912000 x22 0000000000000001 x23 0000000000000000\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x24 0000000070a89d38 x25 0000007fc5734508 x26 0000000000000001 x27 0000007fc5734508\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : x28 0000007fc5734530 x29 0000007fc5734370\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : lr 000b6cf9b5ed7bb0 sp 0000007fc5734350 pc 00000079984c92b8 pst 0000000060001000\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : 38 total frames\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : backtrace:\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #00 pc 000000000005b2b8 /system/lib64/libcamera_client.so (android::Camera::setPreviewCallbackFlags(int)+36) (BuildId: 098f6cbbb6cc82d350c9dc483850b1c5)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #01 pc 00000000001d1bac /system/lib64/libandroid_runtime.so (JNICameraContext::setCallbackMode(_JNIEnv*, bool, bool)+156) (BuildId: 25ea785c07f5997b0afe1d6ef152bfd7)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #02 pc 00000000001d38b0 /system/lib64/libandroid_runtime.so (android_hardware_Camera_setHasPreviewCallback(_JNIEnv*, _jobject*, unsigned char, unsigned char)+96) (BuildId: 25ea785c07f5997b0afe1d6ef152bfd7)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #03 pc 00000000001f0094 /system/framework/arm64/boot-framework.oat (art_jni_trampoline+116) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #04 pc 000000000020a330 /apex/com.android.art/lib64/libart.so (nterp_helper+4016) (BuildId: 9dddd79af0c095a603508841445e00e7)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #05 pc 00000000004d9248 /system/framework/framework.jar (android.hardware.Camera.setPreviewCallbackWithBuffer+40)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #06 pc 000000000020a2d4 /apex/com.android.art/lib64/libart.so (nterp_helper+3924) (BuildId: 9dddd79af0c095a603508841445e00e7)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #07 pc 00000000020de604 /data/app/MIpay/oat/arm64/base.vdex (com.xiaomi.jr.capturephoto.l.a.b+20)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #08 pc 000000000020a2d4 /apex/com.android.art/lib64/libart.so (nterp_helper+3924) (BuildId: 9dddd79af0c095a603508841445e00e7)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #09 pc 000000000226565e /data/app/MIpay/oat/arm64/base.vdex (com.xiaomi.jr.card.detect.IDCardDetectActivity.onDestroy+38)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #10 pc 00000000004b3e54 /system/framework/arm64/boot-framework.oat (android.app.Activity.performDestroy+740) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #11 pc 000000000023a9c4 /system/framework/arm64/boot-framework.oat (android.app.Instrumentation.callActivityOnDestroy+52) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #12 pc 000000000031acc0 /system/framework/arm64/boot-framework.oat (android.app.ActivityThread.performDestroyActivity+992) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #13 pc 0000000000314208 /system/framework/arm64/boot-framework.oat (android.app.ActivityThread.handleDestroyActivity+88) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #14 pc 00000000004d2740 /system/framework/arm64/boot-framework.oat (android.app.servertransaction.DestroyActivityItem.execute+160) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #15 pc 000000000026b764 /system/framework/arm64/boot-framework.oat (android.app.servertransaction.TransactionExecutor.executeLifecycleState+324) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #16 pc 000000000026befc /system/framework/arm64/boot-framework.oat (android.app.servertransaction.TransactionExecutor.execute+764) (BuildId: 77745490bbce729a8fbd8ead27cc579c05ac3d0f)\n08-26 04:36:58.661 10250 27392 27392 F DEBUG : #17 pc 00000000002f8a94 /system/framework/arm64/boot-framework.oat\n\n-----\n\nand here the result shown by using llvm-addr2line:\n\n-----\n\n./llvm-addr2line -C -f -e /home/28041/Workspace/libcamera_client.so 000000000005b2b8\nandroid::sp\u003candroid::hardware::ICamera\u003e::sp(android::sp\u003candroid::hardware::ICamera\u003e const\u0026)\nsystem/core/libutils/include/utils/StrongPointer.h:246\n\n-----\n\nThis issue can be fixed by using \u0027c\u0027 instead of \u0027mCamera\u0027, just like other methods in this file",
      "revId": "20b5d625289f090baf4f9e69061a4e39d6af88b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}